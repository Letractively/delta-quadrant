<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>FeedReader</title>
	<style type="text/css">
	body
	{
		width:260px;
		height:160px;
		margin:4px;
		padding:0px;
	}
	</style>
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript">
	$(document).ready(function(){

		var settingsFeedUrl = System.Gadget.Settings.readString('settingsFeedUrl');
		var settingsMaxTitleLength = System.Gadget.Settings.readString('settingsMaxTitleLength');
		var settingsRequestSleep = System.Gadget.Settings.readString('settingsRequestSleep');

		if(settingsFeedUrl)
		{
			$('#settingsFeedUrl').val(settingsFeedUrl);
		}

		if(settingsMaxTitleLength)
		{
			$('#settingsMaxTitleLength').val(settingsMaxTitleLength);
		}

		if(settingsRequestSleep)
		{
			$('#settingsRequestSleep').val(settingsRequestSleep);
		}

	});

	function settingsClosing(event)
	{
		if(event.closeAction == event.Action.commit)
		{
			var settingsFeedUrl = $('#settingsFeedUrl').val();
			var settingsMaxTitleLength = parseInt($('#settingsMaxTitleLength').val());
			var settingsRequestSleep = parseInt($('#settingsRequestSleep').val());

			if(settingsFeedUrl.length > 7)
			{
				System.Gadget.Settings.writeString('settingsFeedUrl', settingsFeedUrl);
			}
			else
			{
				System.Gadget.Settings.writeString('settingsFeedUrl', 'http://news.google.com/news?topic=t&output=atom');
			}

			if(settingsMaxTitleLength > 0)
			{
				System.Gadget.Settings.writeString("settingsMaxTitleLength", settingsMaxTitleLength);
			}
			else
			{
				System.Gadget.Settings.writeString('settingsMaxTitleLength', '54');
			}

			if(settingsRequestSleep > 0)
			{
				System.Gadget.Settings.writeString('settingsRequestSleep', settingsRequestSleep);
			}
			else
			{
				System.Gadget.Settings.writeString('settingsRequestSleep', '60');
			}
		}

		event.cancel = false;
	}

	System.Gadget.onSettingsClosing = settingsClosing;
	</script>
</head>
<body>

<div id="gadgetContent">
<p>
	<label for="settingsFeedUrl">Feed URL</label><br />
	<input type="url" name="settingsFeedUrl" id="settingsFeedUrl" size="32" value="" />
</p>
<p>
	<label for="settingsMaxTitleLength">Max title length</label><br />
	<input type="text" name="settingsMaxTitleLength" id="settingsMaxTitleLength" size="4" value="" />
</p>
<p>
	<label for="settingsRequestSleep">Request sleep (in seconds)</label><br />
	<input type="text" name="settingsRequestSleep" id="settingsRequestSleep" size="4" value="" />
</p>
</div>

</body>
</html>